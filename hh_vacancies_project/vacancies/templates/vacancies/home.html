{% extends 'vacancies/base.html' %}

{% block page_title %}Добро пожаловать в HH Вакансии{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-8">
        <!-- Приветствие -->
        <div class="card shadow-sm mb-4">
            <div class="card-body">
                <h1 class="display-6 mb-4">Найдите свою идеальную работу</h1>
                <p class="lead">Поиск вакансий с HeadHunter API в реальном времени.</p>
                
                <!-- Быстрый поиск -->
                <div class="search-box p-4 bg-light rounded mb-4">
                    <h5 class="mb-3"><i class="fas fa-search me-2"></i>Начните поиск</h5>
                    <form method="get" action="{% url 'vacancy_list' %}" class="row g-3">
                        <div class="col-md-8">
                            <input type="text" name="q" class="form-control form-control-lg" 
                                   placeholder="Python разработчик, менеджер, дизайнер...">
                        </div>
                        <div class="col-md-4">
                            <button type="submit" class="btn btn-primary btn-lg w-100">
                                <i class="fas fa-search me-2"></i>Найти
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Последние вакансии -->
        <div class="card shadow-sm mb-4">
            <div class="card-header bg-white">
                <h5 class="mb-0"><i class="fas fa-clock me-2"></i>Последние вакансии</h5>
            </div>
            <div class="card-body">
                {% if recent_vacancies %}
                <div class="row">
                    {% for vacancy in recent_vacancies %}
                    <div class="col-md-6 mb-3">
                        <div class="card h-100 border">
                            <div class="card-body">
                                <h6 class="card-title">{{ vacancy.name }}</h6>
                                <p class="card-text text-muted small mb-2">
                                    <i class="fas fa-building me-1"></i>{{ vacancy.employer_name }}
                                </p>
                                <p class="card-text small">
                                    <i class="fas fa-map-marker-alt me-1"></i>{{ vacancy.area }}
                                    <br>
                                    <i class="fas fa-money-bill-wave me-1"></i>{{ vacancy.get_salary_display }}
                                </p>
                                <a href="{% url 'vacancy_detail' vacancy.hh_id %}" 
                                   class="btn btn-outline-primary btn-sm">
                                    Подробнее
                                </a>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div class="text-center mt-3">
                    <a href="{% url 'vacancy_list' %}" class="btn btn-primary">
                        <i class="fas fa-list me-2"></i>Все вакансии
                    </a>
                </div>
                {% else %}
                <div class="alert alert-info">
                    <i class="fas fa-info-circle me-2"></i>
                    Вакансии еще не загружены. 
                    <a href="{% url 'import_vacancies' %}" class="alert-link">
                        Импортируйте первые вакансии
                    </a>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Популярные навыки -->
        {% if popular_skills %}
        <div class="card shadow-sm">
            <div class="card-header bg-white">
                <h5 class="mb-0"><i class="fas fa-star me-2"></i>Популярные навыки</h5>
            </div>
            <div class="card-body">
                <div class="d-flex flex-wrap gap-2">
                    {% for skill, count in popular_skills %}
                    <span class="badge bg-primary bg-opacity-10 text-primary border border-primary border-opacity-25 p-2">
                        {{ skill }} <span class="badge bg-primary rounded-pill ms-1">{{ count }}</span>
                    </span>
                    {% endfor %}
                </div>
            </div>
        </div>
        {% endif %}
    </div>

    <div class="col-lg-4">
        <!-- Статистика -->
        <div class="card shadow-sm mb-4">
            <div class="card-header bg-white">
                <h5 class="mb-0"><i class="fas fa-chart-bar me-2"></i>Статистика</h5>
            </div>
            <div class="card-body">
                <div class="row text-center">
                    <div class="col-6 mb-3">
                        <div class="stat-number text-primary">{{ total_vacancies }}</div>
                        <div class="stat-label text-muted small">Вакансий</div>
                    </div>
                    <div class="col-6 mb-3">
                        <div class="stat-number text-success">{{ total_employers }}</div>
                        <div class="stat-label text-muted small">Работодателей</div>
                    </div>
                    <div class="col-6">
                        <div class="stat-number text-warning">{{ avg_salary_from|floatformat:0 }}₽</div>
                        <div class="stat-label text-muted small">Средняя з/п</div>
                    </div>
                    <div class="col-6">
                        <div class="stat-number text-info">{{ avg_salary_to|floatformat:0 }}₽</div>
                        <div class="stat-label text-muted small">До</div>
                    </div>
                </div>
                <div class="text-center mt-3">
                    <a href="{% url 'statistics' %}" class="btn btn-outline-primary btn-sm">
                        <i class="fas fa-chart-line me-2"></i>Подробная статистика
                    </a>
                </div>
            </div>
        </div>

        <!-- Импорт вакансий -->
        <div class="card shadow-sm mb-4">
            <div class="card-header bg-white">
                <h5 class="mb-0"><i class="fas fa-download me-2"></i>Импорт вакансий</h5>
            </div>
            <div class="card-body">
                <form method="post" action="{% url 'import_vacancies' %}">
                    {% csrf_token %}
                    <div class="mb-3">
                        <label class="form-label">Поисковый запрос</label>
                        <input type="text" name="search_query" class="form-control" 
                               placeholder="Python разработчик..." required>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Количество</label>
                        <input type="number" name="count" class="form-control" 
                               value="30" min="1" max="100">
                    </div>
                    <button type="submit" class="btn btn-primary w-100">
                        <i class="fas fa-cloud-download-alt me-2"></i>Импортировать
                    </button>
                </form>
                <div class="mt-3 small text-muted">
                    <i class="fas fa-info-circle me-1"></i>
                    Данные загружаются с HH.ru в реальном времени
                </div>
            </div>
        </div>

        <!-- Быстрые ссылки -->
        <div class="card shadow-sm">
            <div class="card-header bg-white">
                <h5 class="mb-0"><i class="fas fa-bolt me-2"></i>Быстрые действия</h5>
            </div>
            <div class="card-body">
                <div class="list-group list-group-flush">
                    <a href="{% url 'search' %}" class="list-group-item list-group-item-action">
                        <i class="fas fa-search me-2"></i>Расширенный поиск
                    </a>
                    <a href="{% url 'import_vacancies' %}" class="list-group-item list-group-item-action">
                        <i class="fas fa-database me-2"></i>Загрузить вакансии
                    </a>
                    <a href="{% url 'statistics' %}" class="list-group-item list-group-item-action">
                        <i class="fas fa-chart-pie me-2"></i>Аналитика
                    </a>
                    {% if user.is_superuser %}
                    <a href="/admin/" class="list-group-item list-group-item-action">
                        <i class="fas fa-cog me-2"></i>Админ-панель
                    </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}